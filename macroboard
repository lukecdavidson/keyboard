#! /usr/bin/python

import webbrowser
from evdev import UInput, InputDevice, categorize, ecodes

dev = InputDevice('/dev/input/by-id/usb-NOVATEK_Kensington_U+P_Keyboard-event-kbd')
dev.grab()
ui = UInput()


# Dictionary to assign keycodes to sound files
bindings = {
        'KEY_Q': ['web','https://www.youtube.com'],
        'KEY_W': ['placeholder','placeholder'],
        'KEY_E': ['placeholder','placeholder'],
        'KEY_R': ['placeholder','placeholder'],
        'KEY_T': ['placeholder','placeholder'],
        'KEY_Y': ['placeholder','placeholder'],
        'KEY_U': ['placeholder','placeholder'],
        'KEY_I': ['placeholder','placeholder'],
        'KEY_O': ['placeholder','placeholder'],
        'KEY_P': ['placeholder','placeholder'],
        'KEY_A': ['placeholder','placeholder'],
        'KEY_S': ['placeholder','placeholder'],
        'KEY_D': ['placeholder','placeholder'],
        'KEY_F': ['placeholder','placeholder'],
        'KEY_G': ['placeholder','placeholder'],
        'KEY_H': ['placeholder','placeholder'],
        'KEY_J': ['placeholder','placeholder'],
        'KEY_K': ['placeholder','placeholder'],
        'KEY_L': ['placeholder','placeholder'],
        'KEY_Z': ['placeholder','placeholder'],
        'KEY_X': ['input',['KEY_LEFTALT','KEY_F4']],
        'KEY_C': ['placeholder','placeholder'],
        'KEY_V': ['placeholder','placeholder'],
        'KEY_B': ['placeholder','placeholder'],
        'KEY_N': ['placeholder','placeholder'],
        'KEY_M': ['placeholder','placeholder'],
        }


## Loop to read input from device 
for event in dev.read_loop():
    if event.type == ecodes.EV_KEY:
        key = categorize(event)
        if key.keystate == key.key_down:
            if key.keycode == 'KEY_ESC':
                quit()
            else:
                if key.keycode in bindings:
                    ## bind is assisgned the value of the second item in the list within the bindings values
                    bind = bindings[key.keycode][1]
                    if bindings[key.keycode][0] == 'input':
                        ## write the key specified in the bind_dict
                        for i in bind:
                            key_number = ecodes.ecodes[i]
                            ui.write(ecodes.EV_KEY, key_number, 1)
                            ui.syn()
                        for i in bind:
                            key_number = ecodes.ecodes[i]
                            ui.write(ecodes.EV_KEY, key_number, 0)
                            ui.syn()
                    elif bindings[key.keycode][0] == 'web':
                        webbrowser.open(bind,new=2,autoraise=True)
                    else:
                        print('Key must be a web or input type. Key is currently set to the type: ' + bindings[key.keycode][0])
                else:
                    print(key.keycode + ' is undefined')
